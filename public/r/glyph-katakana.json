{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "glyph-katakana",
  "title": "Glyph Katakana",
  "description": "Glyph katakana component with customizable animation. | カスタマイズ可能なアニメーションを備えたグリフ片仮名コンポーネント。",
  "dependencies": [
    "motion"
  ],
  "files": [
    {
      "path": "components/text/glyph-katakana.tsx",
      "content": "// KatakanaTitle.tsx\r\n\"use client\";\r\nimport React, { useEffect, useRef } from \"react\";\r\nimport { useReducedMotion, useSpring } from \"motion/react\";\r\nimport { cn } from \"@/lib/utils\";\r\n\r\nconst glyphs = [\r\n  \"ア\",\r\n  \"イ\",\r\n  \"ウ\",\r\n  \"エ\",\r\n  \"オ\",\r\n  \"カ\",\r\n  \"キ\",\r\n  \"ク\",\r\n  \"ケ\",\r\n  \"コ\",\r\n  \"サ\",\r\n  \"シ\",\r\n  \"ス\",\r\n  \"セ\",\r\n  \"ソ\",\r\n  \"タ\",\r\n  \"チ\",\r\n  \"ツ\",\r\n  \"テ\",\r\n  \"ト\",\r\n  \"ナ\",\r\n  \"ニ\",\r\n  \"ヌ\",\r\n  \"ネ\",\r\n  \"ノ\",\r\n  \"ハ\",\r\n  \"ヒ\",\r\n  \"フ\",\r\n  \"ヘ\",\r\n  \"ホ\",\r\n  \"マ\",\r\n  \"ミ\",\r\n  \"ム\",\r\n  \"メ\",\r\n  \"モ\",\r\n  \"ヤ\",\r\n  \"ユ\",\r\n  \"ヨ\",\r\n  \"ー\",\r\n  \"ラ\",\r\n  \"リ\",\r\n  \"ル\",\r\n  \"レ\",\r\n  \"ロ\",\r\n  \"ワ\",\r\n  \"ヰ\",\r\n  \"ヱ\",\r\n  \"ヲ\",\r\n  \"ン\",\r\n  \"ガ\",\r\n  \"ギ\",\r\n  \"グ\",\r\n  \"ゲ\",\r\n  \"ゴ\",\r\n  \"ザ\",\r\n  \"ジ\",\r\n  \"ズ\",\r\n  \"ゼ\",\r\n  \"ゾ\",\r\n  \"ダ\",\r\n  \"ヂ\",\r\n  \"ヅ\",\r\n  \"デ\",\r\n  \"ド\",\r\n  \"バ\",\r\n  \"ビ\",\r\n  \"ブ\",\r\n  \"ベ\",\r\n  \"ボ\",\r\n  \"パ\",\r\n  \"ピ\",\r\n  \"プ\",\r\n  \"ペ\",\r\n  \"ポ\",\r\n];\r\n\r\nenum CharType {\r\n  Glyph = \"glyph\",\r\n  Value = \"value\",\r\n}\r\n\r\ninterface CharItem {\r\n  type: CharType;\r\n  value: string;\r\n}\r\n\r\ninterface GlyphKatakanaProps extends React.HTMLAttributes<HTMLSpanElement> {\r\n  /** 目標文字，需為片假名 */\r\n  text: string;\r\n  /** 是否啟動動畫 (預設 true) */\r\n  start?: boolean;\r\n  /** 動畫開始前的延遲時間 (毫秒，預設 0) */\r\n  delay?: number;\r\n}\r\n\r\n/**\r\n * 將輸入的文字陣列轉換為狀態陣列，\r\n * 到位的字元顯示真實文字，其他則隨機取自 glyphs\r\n */\r\nfunction shuffle(\r\n  content: string[],\r\n  current: CharItem[],\r\n  position: number\r\n): CharItem[] {\r\n  return content.map((char, index) => {\r\n    if (index < position) {\r\n      return { type: CharType.Value, value: char };\r\n    }\r\n    // 產生隨機的片假名\r\n    const rand = Math.floor(Math.random() * glyphs.length);\r\n    return { type: CharType.Glyph, value: glyphs[rand] };\r\n  });\r\n}\r\n\r\n/**\r\n * KatakanaTitle - 組件載入時以解碼動畫效果，由隨機片假名逐步呈現正確文字\r\n */\r\nconst GlyphKatakana: React.FC<GlyphKatakanaProps> = (\r\n  ({ text, start = true, delay = 0, className, ...props }) => {\r\n    const containerRef = useRef<HTMLSpanElement>(null);\r\n    const reduceMotion = useReducedMotion();\r\n    const decoderSpring = useSpring(0, { stiffness: 8, damping: 4 });\r\n    const content = text.split(\"\");\r\n    const output = useRef<CharItem[]>(\r\n      content.map(() => ({ type: CharType.Glyph, value: \"\" }))\r\n    );\r\n\r\n    // 定義針對不同文字狀態的 Tailwind class\r\n    const tailwindClasses: Record<string, string> = {\r\n      glyph: \"opacity-50 transition-all\",\r\n      value: \"transition-all\",\r\n    };\r\n\r\n    // 直接操作 innerHTML 將各字元以 span 包裹\r\n    const renderOutput = () => {\r\n      if (containerRef.current) {\r\n        const html = output.current\r\n          .map(\r\n            (item) =>\r\n              `<span class=\"${tailwindClasses[item.type]}\">${item.value}</span>`\r\n          )\r\n          .join(\"\");\r\n        containerRef.current.innerHTML = html;\r\n      }\r\n    };\r\n\r\n    useEffect(() => {\r\n      const unsubscribe = decoderSpring.on(\"change\", (value: number) => {\r\n        output.current = shuffle(content, output.current, Math.floor(value));\r\n        renderOutput();\r\n      });\r\n\r\n      const startAnimation = async () => {\r\n        await new Promise((resolve) => setTimeout(resolve, delay));\r\n        decoderSpring.set(content.length);\r\n      };\r\n\r\n      if (start && !reduceMotion) {\r\n        startAnimation();\r\n      } else {\r\n        output.current = content.map((char) => ({\r\n          type: CharType.Value,\r\n          value: char,\r\n        }));\r\n        renderOutput();\r\n      }\r\n\r\n      return () => {\r\n        unsubscribe();\r\n      };\r\n      // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [decoderSpring, reduceMotion, start, delay, text]);\r\n\r\n    return (\r\n      <span\r\n        className={cn(\r\n          \"inline-block\",\r\n          className\r\n        )}\r\n        {...props}\r\n      >\r\n        <span aria-hidden ref={containerRef} />\r\n      </span>\r\n    );\r\n  }\r\n);\r\n\r\nexport default GlyphKatakana;\r\n",
      "type": "registry:ui"
    }
  ],
  "type": "registry:ui"
}